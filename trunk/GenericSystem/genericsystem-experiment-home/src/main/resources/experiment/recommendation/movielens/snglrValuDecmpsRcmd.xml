<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:jdbc="http://www.springframework.org/schema/jdbc"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.1.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa-1.2.xsd
		http://www.springframework.org/schema/util
		http://www.springframework.org/schema/util/spring-util-2.5.xsd">

	<!-- ******************************************** Algorithm Setting ************************************************ -->
	<bean id="regulrzdSVD" class="edu.tongji.ml.matrix.RegularizedSVD">
		<constructor-arg index="0" type="int" value="${USER_COUNT}" />
		<constructor-arg index="1" type="int" value="${ITEM_COUNT}" />
		<constructor-arg index="2" type="double" value="${MAX_RATING}" />
		<constructor-arg index="3" type="double" value="${MIN_RATING}" />
		<constructor-arg index="4" type="int" value="${FEATURE_COUNT}" />
		<constructor-arg index="5" type="double" value="${LEARNING_RATE}" />
		<constructor-arg index="6" type="double" value="${REGULARIZED_PARAM}" />
		<constructor-arg index="7" type="double" value="${MOMENTUM}" />
		<constructor-arg index="8" type="int" value="${MAX_ITERATION}" />
	</bean>

	<bean id="blockRegulrzdSVD" class="edu.tongji.ml.matrix.BlockRegularizedSVD">
		<constructor-arg index="0" type="int" value="${USER_COUNT}" />
		<constructor-arg index="1" type="int" value="${ITEM_COUNT}" />
		<constructor-arg index="2" type="double" value="${MAX_RATING}" />
		<constructor-arg index="3" type="double" value="${MIN_RATING}" />
		<constructor-arg index="4" type="int" value="${FEATURE_COUNT}" />
		<constructor-arg index="5" type="double" value="${LEARNING_RATE}" />
		<constructor-arg index="6" type="double" value="${REGULARIZED_PARAM}" />
		<constructor-arg index="7" type="double" value="${MOMENTUM}" />
		<constructor-arg index="8" type="int" value="${MAX_ITERATION}" />
	</bean>


	<!-- ******************************************** Engine Setting************************************************ -->
	<bean id="blockSVD"
		class="edu.tongji.engine.recommendation.BlockSnglrValuDecmpsRcmdEngine">
		<property name="loader" ref="blockMatrixDatasetLoader" />
		<property name="blockRecommender" ref="blockRegulrzdSVD" />
	</bean>

	<bean id="stdSVD"
		class="edu.tongji.engine.recommendation.SnglrValuDecmpsRcmdEngine">
		<property name="loader" ref="sparseMatrixDatasetLoader" />
		<property name="recommender" ref="regulrzdSVD" />
	</bean>




	<!-- ******************************************** Thread Setting************************************************ -->
	<bean id="blockMatrixDatasetLoader"
		class="edu.tongji.engine.recommendation.thread.BlockMatrixDataSetLoader">
		<property name="parser" ref="movielensRatingTemplateParser" />
		<property name="settingFile" value="${SETTING_READ_PATH}" />
		<property name="trainingSetFile" value="${TRAININGSET_READ_PATH}" />
		<property name="testingSetFile" value="${TESTINGSET_READ_PATH}" />
		<property name="userCount" value="${USER_COUNT}" />
		<property name="itemCount" value="${ITEM_COUNT}" />
	</bean>

	<bean id="sparseMatrixDatasetLoader"
		class="edu.tongji.engine.recommendation.thread.SparseMatrixDatasetLoader">
		<property name="parser" ref="movielensRatingTemplateParser" />
		<property name="trainingSetFile" value="${TRAININGSET_READ_PATH}" />
		<property name="testingSetFile" value="${TESTINGSET_READ_PATH}" />
		<property name="userCount" value="${USER_COUNT}" />
		<property name="itemCount" value="${ITEM_COUNT}" />
	</bean>

	<bean id="movielensRatingTemplateParser" class="edu.tongji.parser.MovielensRatingTemplateParser" />


	<!-- **************************** Outter Setting Connector ************************************************ -->
	<bean id="propertyConfigurer"
		class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
		<property name="location">
			<value>
				classpath:experiment/recommendation/movielens/z_movielens.properties
			</value>
		</property>
	</bean>

</beans>
